加好友流程
    用户A发起加好友请求
        → 写 Kafka(friend_request)
        → 消费者落库，通知B

    B同意好友请求
        → 写 Kafka(friend_accept)
        → 消费者更新好友关系表，推送通知A


总结
    所有关键事件先写 Kafka，保证可靠性
    业务状态由消费者统一处理和更新数据库
    推送消息由消费者判断在线状态后执行