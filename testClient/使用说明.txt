IM测试客户端使用说明
===================

## 快速开始

### 1. 快速测试
运行: quick-test.bat
说明: 启动调试模式，固定用户1001，目标用户1002

### 2. 单客户端测试
运行: test-single.bat [目标用户ID] [模式]
示例:
  test-single.bat 1002        - 正常模式，需要注册/登录
  test-single.bat 1002 skip   - 调试模式，跳过认证
  test-single.bat 1002 auto   - 自动模式，自动发送消息

### 3. 多客户端启动
运行: startClients.bat
选项:
  1. 正常模式 - 完整的注册/登录认证流程
  2. 调试模式 - 跳过认证，使用固定用户1001
  3. 自动测试 - 启动两个自动发送消息的客户端
  4. 单客户端 - 启动单个调试模式客户端

### 4. 双用户对话测试
运行: test-two-users.bat
选项:
  1. 两个正常模式客户端（需要注册两个不同用户）
  2. 一个调试模式 + 一个正常模式
  3. 手动指定参数

## 用户ID说明

### 调试模式 (-skip)
- 当前用户: 固定1001
- 用户名: debug_user
- Token: auth-debug
- 优点: 快速测试，无需认证
- 缺点: 只能模拟单一用户

### 正常模式
- 当前用户: 通过注册/登录获取
- 用户名: 用户输入
- Token: 服务器生成的JWT
- 优点: 真实的多用户测试
- 缺点: 需要完整的认证流程

## 双用户对话测试方案

### 方案1: 两个正常模式
窗口1: go run main.go -target=用户B的ID
窗口2: go run main.go -target=用户A的ID
说明: 需要先注册两个不同的用户

### 方案2: 混合模式（推荐）
窗口1: go run main.go -target=1002 -skip  (调试模式，用户1001)
窗口2: go run main.go -target=1001        (正常模式，注册真实用户)

## 客户端内命令

help 或 h        - 显示帮助信息
exit 或 quit 或 q - 退出程序
target           - 更改目标用户ID
/to <用户ID>     - 快速切换目标用户
其他输入         - 发送消息

## 注意事项

1. 确保以下服务已启动:
   - User Service (端口21001)
   - Connect Service (端口21005)
   - MongoDB、Redis等基础设施

2. 调试模式固定使用用户ID 1001
3. 正常模式需要注册/登录获取真实用户ID
4. 确保两个客户端的目标用户ID互相对应

## 故障排除

Q: 连接失败
A: 检查Connect Service是否启动，端口21005是否可用

Q: 认证失败
A: 检查用户名密码是否正确，或使用调试模式跳过认证

Q: 消息发送失败
A: WebSocket连接已断开，请重启客户端
